(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[183],{7177:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/category",function(){return a(695)}])},8350:function(e,t,a){"use strict";a.d(t,{Q:function(){return useRequireAuth}});var s=a(1163),r=a(7294),n=a(6770);function useRequireAuth(){let e=(0,s.useRouter)(),{isAuthenticated:t,isLoading:a}=(0,n.a)();return(0,r.useEffect)(()=>{!a&&(t||e.replace("/login"))},[t,a,e]),{isAuthenticated:t,isLoading:a}}},695:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return CategoryPage}});var s=a(5893),r=a(7294),n=a(1163),c=a(2568),i=a(8350);let fetchCategories=async()=>{let e=await fetch("/api/categories");if(!e.ok)throw Error("Request failed with status ".concat(e.status));let t=await e.json();return Array.isArray(null==t?void 0:t.categories)?t.categories:[]};function CategoryPage(){let e=(0,n.useRouter)(),{isAuthenticated:t,isLoading:a}=(0,i.Q)(),[l,o]=(0,r.useState)([]),[d,u]=(0,r.useState)(!0),[x,g]=(0,r.useState)(null);(0,r.useEffect)(()=>{if(!t)return;let e=!1,loadCategories=async()=>{u(!0),g(null);try{let t=await fetchCategories();e||o(t)}catch(t){e||g(t instanceof Error?t.message:"Failed to load categories")}finally{e||u(!1)}};return loadCategories(),()=>{e=!0}},[t]);let y=(0,r.useMemo)(()=>new Map(l.map(e=>[e.categoryId,e])),[l]);return a||!t?null:(0,s.jsxs)(c.Z,{title:"Categories",subtitle:"Curate categories used across transactions and analytics.",children:[(0,s.jsxs)("div",{className:"mb-4 flex items-center justify-between",children:[(0,s.jsx)("h1",{className:"text-xl font-semibold",children:"Categories"}),(0,s.jsx)("button",{type:"button",onClick:()=>e.push("/category/new"),className:"rounded bg-blue-600 px-3 py-1 text-sm font-medium text-white hover:bg-blue-500",children:"Add New Category"})]}),d&&(0,s.jsx)("p",{className:"text-sm text-gray-600",children:"Loading categories..."}),x&&(0,s.jsx)("p",{className:"text-sm text-red-600",role:"alert",children:x}),!d&&!x&&0===l.length&&(0,s.jsx)("p",{className:"text-sm text-gray-600",children:"No categories found yet."}),!d&&!x&&l.length>0&&(0,s.jsx)("div",{className:"overflow-x-auto",children:(0,s.jsxs)("table",{className:"min-w-full divide-y divide-gray-200 text-sm",children:[(0,s.jsx)("thead",{className:"bg-gray-50",children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{scope:"col",className:"px-4 py-2 text-left font-medium text-gray-700",children:"Name"}),(0,s.jsx)("th",{scope:"col",className:"px-4 py-2 text-left font-medium text-gray-700",children:"Kind"}),(0,s.jsx)("th",{scope:"col",className:"px-4 py-2 text-left font-medium text-gray-700",children:"Parent Category"}),(0,s.jsx)("th",{scope:"col",className:"px-4 py-2 text-left font-medium text-gray-700",children:"Description"}),(0,s.jsx)("th",{scope:"col",className:"px-4 py-2 text-right font-medium text-gray-700",children:"Actions"})]})}),(0,s.jsx)("tbody",{className:"divide-y divide-gray-200 bg-white",children:l.map(e=>{var t;let a=null!=e.parentCategoryId?y.get(e.parentCategoryId):null;return(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{className:"px-4 py-2 font-medium text-gray-900",children:e.name}),(0,s.jsx)("td",{className:"px-4 py-2 capitalize text-gray-700",children:e.kind}),(0,s.jsx)("td",{className:"px-4 py-2 text-gray-700",children:a?"".concat(a.name," (").concat(e.parentCategoryId,")"):null!==(t=e.parentCategoryId)&&void 0!==t?t:"None"}),(0,s.jsx)("td",{className:"px-4 py-2 text-gray-700",children:e.description?e.description:"None"}),(0,s.jsxs)("td",{className:"px-4 py-2 text-right text-sm text-blue-600",children:[(0,s.jsx)("button",{type:"button",className:"mr-2 hover:underline",onClick:()=>console.info("Edit category ".concat(e.categoryId)),children:"Edit"}),(0,s.jsx)("button",{type:"button",className:"text-red-600 hover:underline",onClick:()=>console.info("Delete category ".concat(e.categoryId)),children:"Delete"})]})]},e.categoryId)})})]})})]})}}},function(e){e.O(0,[285,568,774,888,179],function(){return e(e.s=7177)}),_N_E=e.O()}]);