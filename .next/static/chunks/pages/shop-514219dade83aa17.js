(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[800],{9173:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/shop",function(){return s(6049)}])},8350:function(e,t,s){"use strict";s.d(t,{Q:function(){return useRequireAuth}});var r=s(1163),n=s(7294),o=s(6770);function useRequireAuth(){let e=(0,r.useRouter)(),{isAuthenticated:t,isLoading:s}=(0,o.a)();return(0,n.useEffect)(()=>{!s&&(t||e.replace("/login"))},[t,s,e]),{isAuthenticated:t,isLoading:s}}},6049:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return ShopPage}});var r=s(5893),n=s(7294),o=s(1163),l=s(2568),i=s(8350);function ShopPage(){let e=(0,o.useRouter)(),{isAuthenticated:t,isLoading:s}=(0,i.Q)(),[d,c]=(0,n.useState)([]),[a,h]=(0,n.useState)(!1),[p,u]=(0,n.useState)(null);(0,n.useEffect)(()=>{if(s||!t)return;let e=!1,fetchShops=async()=>{h(!0),u(null);try{let t=await fetch("/api/shops");if(!t.ok)throw Error("Request failed with status ".concat(t.status));let s=await t.json(),r=Array.isArray(s)?s:null==s?void 0:s.shops;e||(c(Array.isArray(r)?r:[]),Array.isArray(r)||console.warn("Unexpected response shape when fetching shops",s))}catch(t){e||(console.error("Failed to load shops",t),u("Unable to load shops right now."))}finally{e||h(!1)}};return fetchShops(),()=>{e=!0}},[s,t]);let x=(0,n.useMemo)(()=>null!=d?d:[],[d]);return s||!t?null:(0,r.jsxs)(l.Z,{title:"Shops",subtitle:"Manage partner shops and on-site purchases.",children:[(0,r.jsx)("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"1rem"},children:(0,r.jsx)("button",{type:"button",onClick:()=>{e.push("/shop/new").catch(e=>{console.error("Failed to navigate to create shop page",e)})},style:{padding:"0.5rem 1rem",cursor:"pointer"},children:"Add New Shop"})}),a&&(0,r.jsx)("p",{children:"Loading shops..."}),p&&!a&&(0,r.jsx)("p",{style:{color:"red"},children:p}),!a&&!p&&(0,r.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse"},children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{style:{textAlign:"left",borderBottom:"1px solid #ccc",padding:"0.5rem"},children:"Shop Name"}),(0,r.jsx)("th",{style:{textAlign:"left",borderBottom:"1px solid #ccc",padding:"0.5rem"},children:"Type"}),(0,r.jsx)("th",{style:{textAlign:"left",borderBottom:"1px solid #ccc",padding:"0.5rem"},children:"Status"}),(0,r.jsx)("th",{style:{textAlign:"left",borderBottom:"1px solid #ccc",padding:"0.5rem"},children:"Actions"})]})}),(0,r.jsx)("tbody",{children:0===x.length?(0,r.jsx)("tr",{children:(0,r.jsx)("td",{colSpan:4,style:{padding:"0.75rem"},children:"No shops found yet."})}):x.map(e=>(0,r.jsxs)("tr",{style:{borderBottom:"1px solid #eee"},children:[(0,r.jsx)("td",{style:{padding:"0.75rem"},children:e.shopName}),(0,r.jsx)("td",{style:{padding:"0.75rem",textTransform:"capitalize"},children:e.shopType}),(0,r.jsx)("td",{style:{padding:"0.75rem",textTransform:"capitalize"},children:e.status}),(0,r.jsxs)("td",{style:{padding:"0.75rem"},children:[(0,r.jsx)("button",{type:"button",onClick:()=>console.log("Edit shop",e.shopId),style:{marginRight:"0.5rem",padding:"0.25rem 0.5rem",cursor:"pointer"},children:"Edit"}),(0,r.jsx)("button",{type:"button",onClick:()=>console.log("Delete shop",e.shopId),style:{padding:"0.25rem 0.5rem",cursor:"pointer"},children:"Delete"})]})]},e.shopId))})]})]})}}},function(e){e.O(0,[285,568,774,888,179],function(){return e(e.s=9173)}),_N_E=e.O()}]);