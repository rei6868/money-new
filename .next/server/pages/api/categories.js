"use strict";(()=>{var e={};e.id=6957,e.ids=[6957],e.modules={1081:e=>{e.exports=require("dotenv/config")},145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},7612:e=>{e.exports=import("drizzle-orm")},1749:e=>{e.exports=import("drizzle-orm/node-postgres")},8358:e=>{e.exports=import("drizzle-orm/pg-core")},8678:e=>{e.exports=import("pg")},6113:e=>{e.exports=require("crypto")},7435:(e,r,t)=>{t.a(e,async(e,o)=>{try{t.r(r),t.d(r,{config:()=>c,default:()=>l,routeModule:()=>u});var a=t(1802),n=t(7153),s=t(6249),i=t(4810),d=e([i]);i=(d.then?(await d)():d)[0];let l=(0,s.l)(i,"default"),c=(0,s.l)(i,"config"),u=new a.PagesAPIRouteModule({definition:{kind:n.x.PAGES_API,page:"/api/categories",pathname:"/api/categories",bundlePath:"",filename:""},userland:i});o()}catch(e){o(e)}})},4810:(e,r,t)=>{t.a(e,async(e,o)=>{try{t.r(r),t.d(r,{default:()=>handler});var a=t(7612),n=t(6113),s=t(4379),i=t(6986),d=e([a,s,i]);async function handler(e,r){let t=s.db;if(!t){console.error("Database connection is not configured"),r.status(500).json({error:"Database connection is not configured"});return}if("GET"===e.method){try{let e=await t.select().from(i.b).orderBy((0,a.asc)(i.b.name));r.status(200).json(e)}catch(t){console.error("Failed to fetch categories",t);let e=t instanceof Error?t.message:"Unknown error";r.status(500).json({error:e})}return}if("POST"===e.method){try{let o=e.body||{};if(!o.name||!o.kind){r.status(400).json({error:"Validation failed",details:"name and kind are required"});return}let a=i.m.enumValues;if(!a.includes(o.kind)){r.status(400).json({error:"Validation failed",details:`kind must be one of: ${a.join(", ")}`});return}let s={categoryId:(0,n.randomUUID)(),name:o.name,kind:o.kind,parentCategoryId:o.parentCategoryId||null,description:o.description||null},d=await t.insert(i.b).values(s).returning();r.status(201).json(d[0])}catch(t){console.error("Failed to create category",t);let e=t instanceof Error?t.message:"Unknown error";r.status(500).json({error:e})}return}r.setHeader("Allow",["GET","POST"]),r.status(405).json({error:"Method not allowed"})}[a,s,i]=d.then?(await d)():d,o()}catch(e){o(e)}})}};var r=require("../../webpack-api-runtime.js");r.C(e);var __webpack_exec__=e=>r(r.s=e),t=r.X(0,[4222,4379,6986],()=>__webpack_exec__(7435));module.exports=t})();