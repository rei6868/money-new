"use strict";(()=>{var e={};e.id=7398,e.ids=[7398],e.modules={1081:e=>{e.exports=require("dotenv/config")},145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},7612:e=>{e.exports=import("drizzle-orm")},1749:e=>{e.exports=import("drizzle-orm/node-postgres")},8358:e=>{e.exports=import("drizzle-orm/pg-core")},8678:e=>{e.exports=import("pg")},3998:(e,t,r)=>{r.a(e,async(e,o)=>{try{r.r(t),r.d(t,{config:()=>l,default:()=>u,routeModule:()=>c});var a=r(1802),n=r(7153),s=r(6249),i=r(8904),d=e([i]);i=(d.then?(await d)():d)[0];let u=(0,s.l)(i,"default"),l=(0,s.l)(i,"config"),c=new a.PagesAPIRouteModule({definition:{kind:n.x.PAGES_API,page:"/api/categories/[id]",pathname:"/api/categories/[id]",bundlePath:"",filename:""},userland:i});o()}catch(e){o(e)}})},8904:(e,t,r)=>{r.a(e,async(e,o)=>{try{r.r(t),r.d(t,{default:()=>handler});var a=r(7612),n=r(4379),s=r(6986),i=e([a,n,s]);async function handler(e,t){let r=n.db;if(!r){console.error("Database connection is not configured"),t.status(500).json({error:"Database connection is not configured"});return}let{id:o}=e.query,i=Array.isArray(o)?o[0]:o;if(!i){t.status(400).json({message:"Category id is required"});return}if("GET"===e.method){try{let e=await r.select().from(s.b).where((0,a.eq)(s.b.categoryId,i));if(0===e.length){t.status(404).json({message:"Category not found"});return}t.status(200).json(e[0])}catch(r){console.error(`Failed to fetch category with id ${i}`,r);let e=r instanceof Error?r.message:"Unknown error";t.status(500).json({error:e})}return}if("PUT"===e.method||"PATCH"===e.method){try{let o=e.body||{},n={};if(void 0!==o.name&&(n.name=o.name),void 0!==o.parentCategoryId&&(n.parentCategoryId=o.parentCategoryId),void 0!==o.description&&(n.description=o.description),void 0!==o.kind){let e=s.m.enumValues;if(!e.includes(o.kind)){t.status(400).json({error:"Validation failed",details:`kind must be one of: ${e.join(", ")}`});return}n.kind=o.kind}n.updatedAt=new Date;let d=Object.keys(n).filter(e=>"updatedAt"!==e);if(0===d.length){t.status(400).json({error:"No valid fields to update"});return}let u=await r.update(s.b).set(n).where((0,a.eq)(s.b.categoryId,i)).returning();if(0===u.length){t.status(404).json({message:"Category not found"});return}t.status(200).json(u[0])}catch(r){console.error(`Failed to update category with id ${i}`,r);let e=r instanceof Error?r.message:"Unknown error";t.status(500).json({error:e})}return}if("DELETE"===e.method){try{let e=await r.delete(s.b).where((0,a.eq)(s.b.categoryId,i)).returning();if(0===e.length){t.status(404).json({message:"Category not found"});return}t.status(200).json(e[0])}catch(r){console.error(`Failed to delete category with id ${i}`,r);let e=r instanceof Error?r.message:"Unknown error";t.status(500).json({error:e})}return}t.setHeader("Allow",["GET","PUT","PATCH","DELETE"]),t.status(405).json({error:"Method not allowed"})}[a,n,s]=i.then?(await i)():i,o()}catch(e){o(e)}})}};var t=require("../../../webpack-api-runtime.js");t.C(e);var __webpack_exec__=e=>t(t.s=e),r=t.X(0,[4222,4379,6986],()=>__webpack_exec__(3998));module.exports=r})();