"use strict";(()=>{var e={};e.id=8565,e.ids=[8565],e.modules={1081:e=>{e.exports=require("dotenv/config")},145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},7612:e=>{e.exports=import("drizzle-orm")},1749:e=>{e.exports=import("drizzle-orm/node-postgres")},8358:e=>{e.exports=import("drizzle-orm/pg-core")},8678:e=>{e.exports=import("pg")},680:(e,t,r)=>{r.a(e,async(e,n)=>{try{r.r(t),r.d(t,{config:()=>l,default:()=>s,routeModule:()=>d});var a=r(1802),o=r(7153),i=r(6249),u=r(7466),c=e([u]);u=(c.then?(await c)():c)[0];let s=(0,i.l)(u,"default"),l=(0,i.l)(u,"config"),d=new a.PagesAPIRouteModule({definition:{kind:o.x.PAGES_API,page:"/api/transactions/selection",pathname:"/api/transactions/selection",bundlePath:"",filename:""},userland:u});n()}catch(e){n(e)}})},7466:(e,t,r)=>{r.a(e,async(e,n)=>{try{r.r(t),r.d(t,{default:()=>handler});var a=r(8968),o=e([a]);a=(o.then?(await o)():o)[0];let i={count:0,amount:0,totalBack:0,finalPrice:0};function roundCurrency(e){return Number(e.toFixed(2))}async function calculateSelectionSummary(e){if(0===e.length)return i;let t=await (0,a.n)(),r=new Set(e),n=t.reduce((e,t)=>(r.has(t.id)&&(e.count+=1,e.amount+=t.amount,e.totalBack+=t.totalBack,e.finalPrice+=t.finalPrice),e),{...i});return{count:n.count,amount:roundCurrency(n.amount),totalBack:roundCurrency(n.totalBack),finalPrice:roundCurrency(n.finalPrice)}}async function handler(e,t){if("POST"!==e.method){t.setHeader("Allow",["POST"]),t.status(405).json({error:"Method not allowed"});return}try{let r="string"==typeof e.body?JSON.parse(e.body):e.body,n=function(e){if(Array.isArray(e))return e.map(e=>"string"==typeof e?e.trim():"number"==typeof e?String(e):"").filter(e=>e.length>0);if("string"==typeof e){let t=e.trim();return t?[t]:[]}return"number"==typeof e?[String(e)]:[]}(r?.ids);if(0===n.length){t.status(200).json({summary:i});return}let a=await calculateSelectionSummary(n);t.status(200).json({summary:a})}catch(e){console.error("Failed to compute selection summary",e),t.status(500).json({error:"Failed to compute selection summary"})}}n()}catch(e){n(e)}})}};var t=require("../../../webpack-api-runtime.js");t.C(e);var __webpack_exec__=e=>t(t.s=e),r=t.X(0,[4222,4379,6340,3902,6986,6391,7492,7056,8968],()=>__webpack_exec__(680));module.exports=r})();